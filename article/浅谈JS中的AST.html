<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>å¬é±¼çš„åšå®¢</title>
    <meta name="description" content="éšä¾¿ç©ç©">
    <meta name="generator" content="VuePress 1.3.1">
    
    
    <link rel="preload" href="/assets/css/0.styles.341cfc29.css" as="style"><link rel="preload" href="/assets/js/app.5f1549a3.js" as="script"><link rel="preload" href="/assets/js/2.9121317e.js" as="script"><link rel="preload" href="/assets/js/17.064422d1.js" as="script"><link rel="prefetch" href="/assets/js/10.2b223f51.js"><link rel="prefetch" href="/assets/js/100.88f34131.js"><link rel="prefetch" href="/assets/js/101.7bd5d049.js"><link rel="prefetch" href="/assets/js/102.a2416ce9.js"><link rel="prefetch" href="/assets/js/103.b99a3983.js"><link rel="prefetch" href="/assets/js/104.7b14bb74.js"><link rel="prefetch" href="/assets/js/105.48cc9c64.js"><link rel="prefetch" href="/assets/js/106.f5c5fdef.js"><link rel="prefetch" href="/assets/js/107.db559f47.js"><link rel="prefetch" href="/assets/js/11.b41c262c.js"><link rel="prefetch" href="/assets/js/12.11ed69d3.js"><link rel="prefetch" href="/assets/js/13.c3ce1a72.js"><link rel="prefetch" href="/assets/js/14.c76f109f.js"><link rel="prefetch" href="/assets/js/15.a64e573f.js"><link rel="prefetch" href="/assets/js/16.e7fa5866.js"><link rel="prefetch" href="/assets/js/18.02f8761b.js"><link rel="prefetch" href="/assets/js/19.11713135.js"><link rel="prefetch" href="/assets/js/20.9aa94593.js"><link rel="prefetch" href="/assets/js/21.a0315b58.js"><link rel="prefetch" href="/assets/js/22.3304311a.js"><link rel="prefetch" href="/assets/js/23.43780215.js"><link rel="prefetch" href="/assets/js/24.03bcab68.js"><link rel="prefetch" href="/assets/js/25.3892ef13.js"><link rel="prefetch" href="/assets/js/26.7368c3c8.js"><link rel="prefetch" href="/assets/js/27.a447d7a3.js"><link rel="prefetch" href="/assets/js/28.688769d3.js"><link rel="prefetch" href="/assets/js/29.0f5ae53c.js"><link rel="prefetch" href="/assets/js/3.e37f38d1.js"><link rel="prefetch" href="/assets/js/30.835875d4.js"><link rel="prefetch" href="/assets/js/31.d1ebe3d5.js"><link rel="prefetch" href="/assets/js/32.451262e0.js"><link rel="prefetch" href="/assets/js/33.a6fda2b8.js"><link rel="prefetch" href="/assets/js/34.fd67c298.js"><link rel="prefetch" href="/assets/js/35.8cc1d6d7.js"><link rel="prefetch" href="/assets/js/36.ef518f55.js"><link rel="prefetch" href="/assets/js/37.9cd39257.js"><link rel="prefetch" href="/assets/js/38.86233114.js"><link rel="prefetch" href="/assets/js/39.877da125.js"><link rel="prefetch" href="/assets/js/4.e6414d4d.js"><link rel="prefetch" href="/assets/js/40.70dc3d39.js"><link rel="prefetch" href="/assets/js/41.e1a77180.js"><link rel="prefetch" href="/assets/js/42.dbc31dcd.js"><link rel="prefetch" href="/assets/js/43.3871485c.js"><link rel="prefetch" href="/assets/js/44.4449b2e0.js"><link rel="prefetch" href="/assets/js/45.3d48d78f.js"><link rel="prefetch" href="/assets/js/46.9a3471ee.js"><link rel="prefetch" href="/assets/js/47.3b6bfa4c.js"><link rel="prefetch" href="/assets/js/48.9da4ab43.js"><link rel="prefetch" href="/assets/js/49.1ab258d8.js"><link rel="prefetch" href="/assets/js/5.768ecfb1.js"><link rel="prefetch" href="/assets/js/50.209cafdb.js"><link rel="prefetch" href="/assets/js/51.0456622a.js"><link rel="prefetch" href="/assets/js/52.85a0550e.js"><link rel="prefetch" href="/assets/js/53.223fb839.js"><link rel="prefetch" href="/assets/js/54.5ea04027.js"><link rel="prefetch" href="/assets/js/55.a283b62f.js"><link rel="prefetch" href="/assets/js/56.ff2d36de.js"><link rel="prefetch" href="/assets/js/57.96dd32d6.js"><link rel="prefetch" href="/assets/js/58.a29947e9.js"><link rel="prefetch" href="/assets/js/59.8f0833b9.js"><link rel="prefetch" href="/assets/js/6.624eac56.js"><link rel="prefetch" href="/assets/js/60.4ce1076c.js"><link rel="prefetch" href="/assets/js/61.31fcfa18.js"><link rel="prefetch" href="/assets/js/62.08614913.js"><link rel="prefetch" href="/assets/js/63.b8066b11.js"><link rel="prefetch" href="/assets/js/64.2300a12e.js"><link rel="prefetch" href="/assets/js/65.cf63b8ca.js"><link rel="prefetch" href="/assets/js/66.798e9bc2.js"><link rel="prefetch" href="/assets/js/67.8744354c.js"><link rel="prefetch" href="/assets/js/68.91664d01.js"><link rel="prefetch" href="/assets/js/69.b117396d.js"><link rel="prefetch" href="/assets/js/7.ec318c6d.js"><link rel="prefetch" href="/assets/js/70.ddc2e5ee.js"><link rel="prefetch" href="/assets/js/71.80515641.js"><link rel="prefetch" href="/assets/js/72.1c50e6a9.js"><link rel="prefetch" href="/assets/js/73.df5031bc.js"><link rel="prefetch" href="/assets/js/74.30e6d9e4.js"><link rel="prefetch" href="/assets/js/75.88aab629.js"><link rel="prefetch" href="/assets/js/76.8d1ed4d2.js"><link rel="prefetch" href="/assets/js/77.7de6bbe9.js"><link rel="prefetch" href="/assets/js/78.667bf803.js"><link rel="prefetch" href="/assets/js/79.52f48ae6.js"><link rel="prefetch" href="/assets/js/8.5f713608.js"><link rel="prefetch" href="/assets/js/80.470e5818.js"><link rel="prefetch" href="/assets/js/81.15db1e32.js"><link rel="prefetch" href="/assets/js/82.f7534eb2.js"><link rel="prefetch" href="/assets/js/83.4cd16380.js"><link rel="prefetch" href="/assets/js/84.9e4cf4b7.js"><link rel="prefetch" href="/assets/js/85.2daeb56c.js"><link rel="prefetch" href="/assets/js/86.62c75f2a.js"><link rel="prefetch" href="/assets/js/87.f4038b2d.js"><link rel="prefetch" href="/assets/js/88.30c294eb.js"><link rel="prefetch" href="/assets/js/89.ff8e509c.js"><link rel="prefetch" href="/assets/js/9.0adc4cd7.js"><link rel="prefetch" href="/assets/js/90.84efa137.js"><link rel="prefetch" href="/assets/js/91.b8ca7db3.js"><link rel="prefetch" href="/assets/js/92.5ecfca64.js"><link rel="prefetch" href="/assets/js/93.50b8a095.js"><link rel="prefetch" href="/assets/js/94.920b2d6c.js"><link rel="prefetch" href="/assets/js/95.1951a5fe.js"><link rel="prefetch" href="/assets/js/96.37e4257f.js"><link rel="prefetch" href="/assets/js/97.1171a0e1.js"><link rel="prefetch" href="/assets/js/98.5f53030b.js"><link rel="prefetch" href="/assets/js/99.29d49bbc.js">
    <link rel="stylesheet" href="/assets/css/0.styles.341cfc29.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">å¬é±¼çš„åšå®¢</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/article/æµ…è°ˆJSä¸­çš„AST.html" class="nav-link">
  æ–‡ç« 
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="åŸºç¡€çŸ¥è¯†" class="dropdown-title"><span class="title">åŸºç¡€çŸ¥è¯†</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/basic/html5/BrowsingContext.html" class="nav-link">
  HTML5
</a></li><li class="dropdown-item"><!----> <a href="/basic/css3/flex.html" class="nav-link">
  CSS3
</a></li><li class="dropdown-item"><!----> <a href="/basic/javascript/ä½œç”¨åŸŸ.html" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/basic/nodejs/ä½œç”¨åŸŸ.html" class="nav-link">
  NodeJS
</a></li><li class="dropdown-item"><!----> <a href="/basic/typescript/basic.html" class="nav-link">
  TypeScript
</a></li><li class="dropdown-item"><!----> <a href="/basic/browser/cors.html" class="nav-link">
  Browser
</a></li><li class="dropdown-item"><!----> <a href="/basic/webpack/webpack4.html" class="nav-link">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/basic/react/react-kernel.html" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/basic/vue/vue-loader.html" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/basic/minip/FAQ.html" class="nav-link">
  Minip
</a></li><li class="dropdown-item"><!----> <a href="/basic/network/" class="nav-link">
  Network
</a></li><li class="dropdown-item"><!----> <a href="/basic/git/command.html" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/basic/docker/åŸºç¡€ç¯‡.html" class="nav-link">
  Docker
</a></li><li class="dropdown-item"><!----> <a href="/basic/db/èŒƒå¼.html" class="nav-link">
  DataBase
</a></li><li class="dropdown-item"><!----> <a href="/basic/linux/bash.html" class="nav-link">
  Linux
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/article/æµ…è°ˆJSä¸­çš„AST.html" class="nav-link">
  æ–‡ç« 
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="åŸºç¡€çŸ¥è¯†" class="dropdown-title"><span class="title">åŸºç¡€çŸ¥è¯†</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/basic/html5/BrowsingContext.html" class="nav-link">
  HTML5
</a></li><li class="dropdown-item"><!----> <a href="/basic/css3/flex.html" class="nav-link">
  CSS3
</a></li><li class="dropdown-item"><!----> <a href="/basic/javascript/ä½œç”¨åŸŸ.html" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/basic/nodejs/ä½œç”¨åŸŸ.html" class="nav-link">
  NodeJS
</a></li><li class="dropdown-item"><!----> <a href="/basic/typescript/basic.html" class="nav-link">
  TypeScript
</a></li><li class="dropdown-item"><!----> <a href="/basic/browser/cors.html" class="nav-link">
  Browser
</a></li><li class="dropdown-item"><!----> <a href="/basic/webpack/webpack4.html" class="nav-link">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/basic/react/react-kernel.html" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/basic/vue/vue-loader.html" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/basic/minip/FAQ.html" class="nav-link">
  Minip
</a></li><li class="dropdown-item"><!----> <a href="/basic/network/" class="nav-link">
  Network
</a></li><li class="dropdown-item"><!----> <a href="/basic/git/command.html" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/basic/docker/åŸºç¡€ç¯‡.html" class="nav-link">
  Docker
</a></li><li class="dropdown-item"><!----> <a href="/basic/db/èŒƒå¼.html" class="nav-link">
  DataBase
</a></li><li class="dropdown-item"><!----> <a href="/basic/linux/bash.html" class="nav-link">
  Linux
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/article/æµ…è°ˆJSä¸­çš„AST.html" class="active sidebar-link">æµ…è°ˆJSä¸­çš„AST</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/article/æµ…è°ˆJSä¸­çš„AST.html#ä»‹ç»" class="sidebar-link">ä»‹ç»</a></li><li class="sidebar-sub-header"><a href="/article/æµ…è°ˆJSä¸­çš„AST.html#ast-æ— å¤„ä¸åœ¨" class="sidebar-link">AST æ— å¤„ä¸åœ¨</a></li><li class="sidebar-sub-header"><a href="/article/æµ…è°ˆJSä¸­çš„AST.html#å¸¸è§çš„-parser" class="sidebar-link">å¸¸è§çš„ parser</a></li><li class="sidebar-sub-header"><a href="/article/æµ…è°ˆJSä¸­çš„AST.html#å­¦ä¹ ä½¿ç”¨-babel-parser" class="sidebar-link">å­¦ä¹ ä½¿ç”¨@babel/parser</a></li></ul></li><li><a href="/article/å®ç°ä¸€ä¸ªç®€å•çš„WEBæ‰“åŒ…å·¥å…·.html" class="sidebar-link">å®ç°ä¸€ä¸ªç®€å•çš„WEBæ‰“åŒ…å·¥å…·</a></li><li><a href="/article/è§£ævue3çš„å“åº”å¼.html" class="sidebar-link">è§£ævue3çš„å“åº”å¼</a></li><li><a href="/article/é‡æ–°æ¢³ç†ES5å’ŒES6çš„ç»§æ‰¿.html" class="sidebar-link">é‡æ–°æ¢³ç†ES5å’ŒES6çš„ç»§æ‰¿</a></li><li><a href="/article/Jestæºç æ•´ç†.html" class="sidebar-link">Jestæºç æ•´ç†</a></li><li><a href="/article/ä»€ä¹ˆæ˜¯å¥æŸ„.html" class="sidebar-link">ä»€ä¹ˆæ˜¯å¥æŸ„</a></li><li><a href="/article/localhostå’Œå…¨é›¶IP.html" class="sidebar-link">localhostå’Œå…¨é›¶IP</a></li><li><a href="/article/åœ¨VSCodeä¸­debug.html" class="sidebar-link">åœ¨VSCodeä¸­debug</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>å¯ä»¥é€šè¿‡<a href="https://astexplorer.net/" target="_blank" rel="noopener noreferrer">astexplorer<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ç½‘ç«™åœ¨çº¿é¢„è§ˆä»£ç å¯¹äºçš„ ASTã€‚</p> <p>å¯ä»¥é€šè¿‡<a href="https://resources.jointjs.com/demos/javascript-ast" target="_blank" rel="noopener noreferrer">jointjs<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ç½‘ç«™åœ¨çº¿å¯è§†åŒ–é¢„è§ˆ ASTã€‚</p></div> <p></p><div class="table-of-contents"><ul><li><a href="#ä»‹ç»">ä»‹ç»</a></li><li><a href="#ast-æ— å¤„ä¸åœ¨">AST æ— å¤„ä¸åœ¨</a></li><li><a href="#å¸¸è§çš„-parser">å¸¸è§çš„ parser</a></li><li><a href="#å­¦ä¹ ä½¿ç”¨-babel-parser">å­¦ä¹ ä½¿ç”¨@babel/parser</a><ul><li><a href="#è½¬æ¢æ­¥éª¤">è½¬æ¢æ­¥éª¤</a></li><li><a href="#babel-traverse-çš„ä½¿ç”¨">@babel/traverse çš„ä½¿ç”¨</a></li></ul></li></ul></div><p></p> <h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="header-anchor">#</a> ä»‹ç»</h2> <p>AST çš„å…¨ç§°æ˜¯ <a href="https://en.wikipedia.org/wiki/Abstract_syntax_tree" target="_blank" rel="noopener noreferrer">abstract syntax tree<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œå³æŠ½è±¡è¯­æ³•æ ‘ï¼Œé€šè¿‡ parser å¯¹æºä»£ç è¿›è¡Œè§£æç”Ÿæˆçš„ä¸€ç§æŠ½è±¡è¯­æ³•ç»“æ„çš„æ ‘çŠ¶è¡¨ç°å½¢å¼ï¼Œä»£ç ä»¥æ•°æ®ç»“æ„çš„å½¢å¼å­˜åœ¨æ›´åˆ©äºå¯¹å…¶è¿›è¡Œä¿®æ”¹ï¼Œæœ€ç»ˆå†è¿˜åŸæˆæºä»£ç ã€‚</p> <p><img src="/assets/img/ast.42267193.png" alt=""></p> <h2 id="ast-æ— å¤„ä¸åœ¨"><a href="#ast-æ— å¤„ä¸åœ¨" class="header-anchor">#</a> AST æ— å¤„ä¸åœ¨</h2> <p>å¹³æ—¶å¸¸è§çš„æ¡†æ¶ä¸­éƒ½ä¼šç”¨åˆ° ASTï¼Œå¦‚æœæˆ‘ä»¬æŒæ¡äº†å¯¹ AST çš„ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥ç ”å‘å‡ºåŸºäºè¯­æ³•è½¬æ¢çš„æ¡†æ¶ã€‚</p> <ul><li>IDE çš„é”™è¯¯æç¤ºã€ä»£ç æ ¼å¼åŒ–ã€ä»£ç é«˜äº®ã€ä»£ç è‡ªåŠ¨è¡¥å…¨ç­‰</li> <li>ESLint å¯¹ä»£ç é”™è¯¯æˆ–é£æ ¼çš„æ£€æŸ¥ç­‰</li> <li>webpackã€rollup è¿›è¡Œä»£ç æ‰“åŒ…ç­‰</li> <li>TypeScriptã€Reactã€Vue ç­‰è½¬åŒ–ä¸ºåŸç”Ÿ Javascript</li></ul> <h2 id="å¸¸è§çš„-parser"><a href="#å¸¸è§çš„-parser" class="header-anchor">#</a> å¸¸è§çš„ parser</h2> <p>parser é€šè¿‡è§£ææºä»£ç çš„è¯­æ³•è¯æ±‡ã€è¯­ä¹‰ã€ä½œç”¨åŸŸï¼Œæœ€ç»ˆç”Ÿæˆ ASTã€‚ä¸åŒçš„ parser å¯¹æºä»£ç çš„è§£æç®—æ³•ä¸åŒï¼Œå‚ç…§çš„ã€Œæ ‘çŠ¶ç»“æ„è¯­æ³•è¡¨è¿°è§„èŒƒã€ä¹Ÿæœ‰å·®åˆ«ï¼Œä¸è¿‡å¤§å¤šéƒ½åŸºäº<a href="https://github.com/estree/estree" target="_blank" rel="noopener noreferrer">estree<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>è§„èŒƒã€‚</p> <p>å¸¸è§çš„ parser æœ‰ï¼š</p> <ul><li>acorn</li> <li>espree</li> <li>esprima</li> <li>traceur</li> <li>shift</li> <li>@babel/parser(babylon)-fork è‡ª Acorn</li></ul> <h2 id="å­¦ä¹ ä½¿ç”¨-babel-parser"><a href="#å­¦ä¹ ä½¿ç”¨-babel-parser" class="header-anchor">#</a> å­¦ä¹ ä½¿ç”¨@babel/parser</h2> <p>è¿™é‡Œä»¥å¦‚ä½•ä½¿ç”¨@babel/parser ä¸ºä¾‹ï¼Œå› ä¸ºå¹³æ—¶æˆ‘ä»¬ä½¿ç”¨ babel å®¶æ—çš„ä¸œè¥¿æ¯”è¾ƒå¤šï¼Œä»å®ƒå…¥æ‰‹å†å¥½ä¸è¿‡äº†ã€‚</p> <h3 id="è½¬æ¢æ­¥éª¤"><a href="#è½¬æ¢æ­¥éª¤" class="header-anchor">#</a> è½¬æ¢æ­¥éª¤</h3> <ol><li>é€šè¿‡@babel/parser å°†æºä»£ç è½¬æ¢æˆ AST</li> <li>å€ŸåŠ©@babel/traverse éå† ASTï¼Œè¿›è¡Œè½¬æ¢</li> <li>ä½¿ç”¨@babel/core ä¸­çš„ transformFromAst å°† AST è¿˜åŸæˆä»£ç </li></ol> <h3 id="babel-traverse-çš„ä½¿ç”¨"><a href="#babel-traverse-çš„ä½¿ç”¨" class="header-anchor">#</a> @babel/traverse çš„ä½¿ç”¨</h3> <p>æˆ‘ä»¬å°†åŒ¹é… AST èŠ‚ç‚¹ç±»å‹çš„æ–¹æ³•ä¼ å…¥ï¼Œ@babel/traverse éå†åˆ°ä¸æ–¹æ³•åç›¸åŒçš„èŠ‚ç‚¹ç±»å‹æ—¶å°±ä¼šè°ƒç”¨è¯¥æ–¹æ³•ï¼Œ<a href="https://github.com/jamiebuilds/babel-handbook/blob/master/translations/en/plugin-handbook.md#visitors" target="_blank" rel="noopener noreferrer">å®˜æ–¹è¯´æ˜<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚</p> <p>ä¾‹å­ï¼š</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> parser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;@babel/parser&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> traverse <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;@babel/traverse&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>default<span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> transformFromAst <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;@babel/core&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> content <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  function square(n) {
    return n * n;
  }
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token keyword">const</span> ast <span class="token operator">=</span> <span class="token function">parser</span><span class="token punctuation">(</span>content<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  sourceType<span class="token operator">:</span> <span class="token string">&quot;module&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> Visitor <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">Identifier</span><span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Called!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token function">traverse</span><span class="token punctuation">(</span>content<span class="token punctuation">,</span> Visitor<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> code <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">transformFromAst</span><span class="token punctuation">(</span>ast<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
fs<span class="token punctuation">.</span><span class="token function">writeFileSync</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;./output.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> code<span class="token punctuation">,</span> <span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>ä¸Šè¿°ä»£ç æ‰§è¡Œåä¼šè¾“å‡º 4 æ¬¡<code>Called!</code>ï¼Œå› ä¸ºæ–¹æ³•å<code>square</code>å’Œ 3 ä¸ª<code>n</code>çš„ç±»å‹æ˜¯ <code>Identifier</code>ï¼Œæˆ‘ä»¬åœ¨ Visitor ä¸­çš„åŒåå‡½æ•°å°±ä¼šè¢«æ‰§è¡Œã€‚</p> <p>èŠ‚ç‚¹ç±»å‹å›è°ƒå‡½æ•°å¯æ¥å—ä¸€ä¸ª<code>path</code>å˜é‡ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¯å˜(mutable)å¯¹è±¡ï¼ŒåŒ…å«äº†è¯¥èŠ‚ç‚¹åœ¨æ ‘ä¸­ä½ç½®å’Œå„ç§è‡ªèº«ä¿¡æ¯ï¼Œä½ å¯ä»¥ç›´æ¥æ”¹å˜å®ƒæˆ–æ˜¯è°ƒç”¨å®ƒçš„æ–¹æ³•ï¼Œå¸¸ç”¨çš„æœ‰çˆ¶èŠ‚ç‚¹<code>path.parent</code>ï¼Œå½“å‰èŠ‚ç‚¹<code>path.node</code>ï¼Œä½œç”¨åŸŸ<code>path.scope</code>ï¼Œè¿˜æœ‰å†…åµŒéå†æ–¹æ³•<code>path.traverse()</code>ï¼Œå®ƒå¯ä»¥åµŒå¥—éå†è¯¥èŠ‚ç‚¹çš„åä»£ï¼Œä¸è¿‡è¦è°¨æ…çš„ä½¿ç”¨å®ƒï¼Œå› ä¸ºå®ƒä¼šå¢åŠ ä»£ç æ—¶é—´å¤æ‚åº¦ã€‚</p> <p>èŠ‚ç‚¹ç±»å‹å¯ä»¥æœ‰åˆ«åï¼Œæ¯”å¦‚<code>Function</code>æ˜¯<code>FunctionDeclaration</code>ã€<code>FunctionExpression</code>ã€<code>ArrowFunctionExpression</code>ã€<code>ObjectMethod</code>å’Œ<code>ClassMethod</code>çš„åˆ«åï¼Œæ›´å¤šçš„èŠ‚ç‚¹ç±»å‹å®šä¹‰å‚è€ƒ<a href="https://www.npmjs.com/package/babel-types" target="_blank" rel="noopener noreferrer">babel-types<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>æ–‡æ¡£ã€‚</p> <p>é€šè¿‡<code>babel-types</code>æä¾›çš„æ–¹æ³•å’Œ<code>path</code>å˜é‡çš„ç›¸å…³ APIï¼Œå¯ä»¥æ»¡è¶³æ“ä½œ AST çš„æ—¥å¸¸éœ€æ±‚ï¼Œæ›´å¤šæ“ä½œæ–¹æ³•å¯ä»¥å‚è€ƒ<a href="https://github.com/jamiebuilds/babel-handbook/blob/master/translations/en/plugin-handbook.md#toc-transformation-operations" target="_blank" rel="noopener noreferrer">å®˜æ–¹æ–‡æ¡£<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚</p> <h4 id="visitor-identifier-çš„å¤šç§å†™æ³•"><a href="#visitor-identifier-çš„å¤šç§å†™æ³•" class="header-anchor">#</a> Visitor.Identifier çš„å¤šç§å†™æ³•</h4> <p>èŠ‚ç‚¹ç±»å‹å›è°ƒå‡½æ•°æ”¯æŒå¤šç§å†™æ³•ï¼Œä¸‹é¢å‡ ç§å¯ä»¥è¾¾åˆ°åŒæ ·çš„æ•ˆæœã€‚</p> <p>ç¬¬ä¸€ç§ï¼š</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> Visitor <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">FunctionDeclaration</span><span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">Identifier</span><span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>ç¬¬äºŒç§ï¼š<code>Identifier() { ... }</code> æ˜¯ <code>Identifier: { enter() { ... } }</code>çš„ç¼©å†™å½¢å¼ï¼Œä¸ <code>enter()</code> å¯¹åº”çš„æ˜¯ <code>exit()</code>ï¼Œéå†è¿‡ç¨‹ä¸­å¯¹åŒä¸€ä¸ªèŠ‚ç‚¹ä¼šæœ‰ enter å’Œ exit ä¸¤ä¸ªå›è°ƒã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> Visitor <span class="token operator">=</span> <span class="token punctuation">{</span>
  FunctionDeclaration<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">enter</span><span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  Identifier<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">enter</span><span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>ç¬¬ä¸‰ç§ï¼š</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> Visitor <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">enter</span><span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> type <span class="token operator">=</span> path<span class="token punctuation">.</span>node<span class="token punctuation">.</span>type<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">&quot;FunctionDeclaration&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">&quot;Identifier&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="header-anchor">#</a> æ³¨æ„äº‹é¡¹</h4> <ul><li><code>path.traverse(visitor, state)</code>ä¸­çš„ state å¯ä»¥åœ¨å†…åµŒ visitor ä¸­é€šè¿‡ this è®¿é—®ã€‚</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> updateParamNameVisitor <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">Identifier</span><span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>paramName<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// a</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> Visitor <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">FunctionDeclaration</span><span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    path<span class="token punctuation">.</span><span class="token function">traverse</span><span class="token punctuation">(</span>updateParamNameVisitor<span class="token punctuation">,</span> <span class="token punctuation">{</span> paramName<span class="token operator">:</span> <span class="token string">&quot;a&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><ul><li>å†…åµŒçš„ Visitor ä¸ä¼šå½±å“å¤–å±‚ Visitor çš„æ‰§è¡Œï¼Œä¸‹è¿°ä»£ç æ‰§è¡Œåï¼Œä¼šè¾“å‡º 3 æ¬¡ outter å’Œ 1 æ¬¡ innerï¼Œå› æ­¤è¦å°å¿ƒè¢«é‡å¤éå†åˆ°çš„é‚£éƒ¨åˆ†å¤„ç†é€»è¾‘ã€‚</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// input.js</span>
<span class="token keyword">function</span> <span class="token function">square</span><span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">hh</span><span class="token punctuation">(</span><span class="token parameter">b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> b <span class="token operator">+</span> b<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> n <span class="token operator">*</span> n<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> n <span class="token operator">+</span> n<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// transform.js</span>
<span class="token keyword">const</span> updateParamNameVisitor <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">FunctionDeclaration</span><span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;inner&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> Visitor <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">FunctionDeclaration</span><span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;outter&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    path<span class="token punctuation">.</span><span class="token function">traverse</span><span class="token punctuation">(</span>updateParamNameVisitor<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h4 id="å¸¸è§çš„é”™è¯¯ä½¿ç”¨æ¡ˆä¾‹"><a href="#å¸¸è§çš„é”™è¯¯ä½¿ç”¨æ¡ˆä¾‹" class="header-anchor">#</a> å¸¸è§çš„é”™è¯¯ä½¿ç”¨æ¡ˆä¾‹</h4> <ul><li>ä¾‹å­ä¸€ï¼šæŠŠä¸‹è¿°ä»£ç ä¸­ square å‡½æ•°çš„ n è½¬æ¢æˆ x</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// input.js</span>
<span class="token keyword">function</span> <span class="token function">square</span><span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> n <span class="token operator">*</span> n<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
n<span class="token punctuation">;</span>
<span class="token comment">// transform.js</span>
<span class="token keyword">let</span> paramName<span class="token punctuation">;</span>
<span class="token keyword">const</span> MyVisitor <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">FunctionDeclaration</span><span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> param <span class="token operator">=</span> path<span class="token punctuation">.</span>node<span class="token punctuation">.</span>params<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    paramName <span class="token operator">=</span> param<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
    param<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;x&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">Identifier</span><span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>path<span class="token punctuation">.</span>node<span class="token punctuation">.</span>name <span class="token operator">===</span> paramName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      path<span class="token punctuation">.</span>node<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;x&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// output.js</span>
<span class="token keyword">function</span> <span class="token function">square</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> x <span class="token operator">*</span> x<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
x<span class="token punctuation">;</span> <span class="token comment">// error</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>åº”è¯¥æ˜¯è¿™æ ·ï¼š</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> updateParamNameVisitor <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">Identifier</span><span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>path<span class="token punctuation">.</span>node<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token keyword">this</span><span class="token punctuation">.</span>paramName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      path<span class="token punctuation">.</span>node<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;x&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> MyVisitor <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">FunctionDeclaration</span><span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> param <span class="token operator">=</span> path<span class="token punctuation">.</span>node<span class="token punctuation">.</span>params<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> paramName <span class="token operator">=</span> param<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
    param<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;x&quot;</span><span class="token punctuation">;</span>
    path<span class="token punctuation">.</span><span class="token function">traverse</span><span class="token punctuation">(</span>updateParamNameVisitor<span class="token punctuation">,</span> <span class="token punctuation">{</span> paramName <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
path<span class="token punctuation">.</span><span class="token function">traverse</span><span class="token punctuation">(</span>MyVisitor<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>åœ¨<a href="/article/å®ç°ä¸€ä¸ªç®€å•çš„WEBæ‰“åŒ…å·¥å…·.html">åæ–‡</a>ä¸­ä¼šæœ‰å®é™…çš„åº”ç”¨ ğŸ˜Šã€‚</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/article/å®ç°ä¸€ä¸ªç®€å•çš„WEBæ‰“åŒ…å·¥å…·.html">
        å®ç°ä¸€ä¸ªç®€å•çš„WEBæ‰“åŒ…å·¥å…·
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.5f1549a3.js" defer></script><script src="/assets/js/2.9121317e.js" defer></script><script src="/assets/js/17.064422d1.js" defer></script>
  </body>
</html>
