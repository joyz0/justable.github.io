- 应用层：发出请求
- 传输层（TCP/UDP）：把从应用层收到的数据（HTTP 请求报文）进行分割，并在各个报文上打上标记序号及端口号后转发给网络层
- 网络层（IP 地址）：网络层是根据 IP 地址进行传输的，在报文中增加 MAC 地址后转发给链路层
- 链路层（MAC 地址）：负责处理网络中的硬件部分，链路层会根据报文中的 MAC 地址传输到目的机器上

### IP 地址和 MAC 地址

IP 地址是根据区域分配的，MAC 地址是刻录在网卡中的，当一台计算机有多网卡时，也就意味着有多个 MAC 地址，MAC 地址不会随着机器的地域迁移而改变。IP 地址很 MAC 地址的映射关系基于 ARP 协议，并且每台主机都会在自己的 ARP 缓存区中建立一个 ARP 列表，以表示 IP 地址和 MAC 地址的对应关系。

### ARP 协议

当一台主机（可以是源主机也可以是中转中的某一台主机）需要将一个数据包转发到另一台主机时，会先在本地的 ARP 缓存区中查找是否存在目标 IP 地址所对应的 MAC 地址，如果有则直接在数据包中加上目的 MAC 地址，那么这个数据包的下一站就会传给这个 MAC 地址；如果没有找到，就向本地网段发起一个 ARP 请求的广播包，此 ARP 请求包含了发送端主机的 IP 地址、MAC 地址和目标主机的 IP 地址，网络中的所有主机收到这个 ARP 请求后，会检查是否自己就是这个目标主机，如果是则回应并将 ARP 请求所携带的发送端主机的 IP 地址和 MAC 地址映射关系更新到本地 ARP 缓存中，不是则忽略。这一切都是基于信任的，所以事实上会存在 ARP 虚假回应。发生端主机收到回应后也会更新本地的 ARP 缓存。

### 网络拓扑

网络中的传输都是基于网络拓扑的，网络拓扑会有不同的结构形式，有总线形拓扑、星形拓扑、环形拓、树形拓扑以及混合形拓扑，一个网关管辖着一块区域的主机，而这个网关又相当于上级网关的主机，这些网关 IP 都是基于地域分配的，每台主机第一次请求都会向自己的默认网关发起，层层向上，之所以强调第一次请求，是因为网络拓扑其实是个寻址的过程，在理想情况下，某次成功的请求是可以被缓存下来的，那么下次请求就无需层层向上查找目的地了。
