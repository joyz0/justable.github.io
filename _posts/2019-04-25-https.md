---
title: "https"
date: 2019-04-25 17:55:00
categories: [blog]
tags: [https]
---

HTTPS 是 HTTP+SSL

### SSL 认证流程

1. Client A 用加密算法 S 将数字 1 加密生成 S1，把 S，S1 和自己支持的 SSL 版本传给 Server B
2. Server B 使用加密算法 S 解密 S1 得到数字 1，使用 S 将数字 2 加密生成 S2，把 S2，CA 机构颁发给自己的证书 C 和公钥 P 传给 Client A
3. Client A 使用加密算法 S 解密 S2 得到数字 2，验证证书 C 的有效性，使用公钥 P 将数字 3 加密生成 P3，把 P3 传给 Server B
4. Server B 使用私钥解密 P3 得到数字 3（不对称加密结束），至此双方都有了数字 1，2，3，然后用加密算法（一般为 AES）将数字 1，2，3 加密生成 S123，之后的内容都通过 S123 进行对称加密传输

### HTTP/1.x 和 HTTP/2

- HTTP/1.x 情况下，浏览器和服务端的每个 TCP 连接只允许一个 http 请求，多个请求只能等待前一个请求完成，现代浏览器为了缓节状况通常会打开多个并行的 TCP 连接，通常是 2-8 个，不同浏览器不同。但这终究只是缓解，并没有真正解决问题。
- HTTP/2 情况下，浏览器和服务器之间的所有请求都在一个 TCP 连接上进行多路复用，节省了 TCP 连接打开和关闭的开销。

### 雪碧图

在 HTTP/1.x 情况下，通过雪碧图集合可以很好的减少请求数量提升加载速度，这毋庸置疑，但在 HTTP/2，在多路复用的前提下，这还有意义吗？请见[这篇文章](https://blog.octo.com/en/http2-arrives-but-sprite-sets-aint-no-dead/)
